#cloud-config
chpasswd:
  expire: false
  list: |
    root:{{ tmos_root_password }}
    admin:{{ tmos_admin_password }}
ssh_authorized_keys:
  - {{ tmos_root_authorized_ssh_key }}
tmos_declared:
  enabled: true
  icontrollx_trusted_sources: false
  icontrollx_package_urls:
    - {{ do_url }}
    - {{ as3_url }}
  do_declaration:
    schemaVersion: 1.0.0
    class: Device
    async: true
    label: Cloudinit Onboarding
    Common:
      class: Tenant
      hostname: secondary-adc-instance.local
      provisioningLevels:
        class: Provision
        ltm: nominal
      poolLicense:
        class: License
        licenseType: licensePool
        bigIqHost: {{ license_host }}
        bigIqUsername: {{ license_username }}
        bigIqPassword: {{ license_password }}
        licensePool: {{ license_pool }}
        reachable: true
        bigIpUsername: admin
        bigIpPassword: {{ tmos_admin_password }}
      dnsServers:
        class: DNS
        nameServers:
          - {{ dns_server }}
        search:
          - example.openstack.com
      ntpServers:
        class: NTP
        servers:
          - 0.pool.ntp.org
          - 1.pool.ntp.org
          - 2.pool.ntp.org
      external:
        class: VLAN
        mtu: {{ vip_mtu_secondary }}
        interfaces:
          - name: 1.1
            tagged: false
      external-self:
        class: SelfIp
        address: "{{ vip_selfip_secondary }}/{{ vip_mask_secondary }}"
        vlan: external
        allowService: none
        trafficGroup: traffic-group-local-only
      default:
        class: Route
        gw: {{ default_gateway_secondary }}
        network: default
        mtu: {{ vip_mtu_secondary }}
      configsync:
        class: ConfigSync
        configsyncIp: /Common/external-self/address
      failoverAddress:
        class: FailoverUnicast
        address: /Common/external-self/address
      dbvars:
        class: DbVariables
        ui.advisory.enabled: true
        ui.advisory.color: orange
        ui.advisory.text: This device is under centralized management.
      activeStandbyGroup:
        class: DeviceGroup
        type: sync-failover
        owner: secondary-adc-instance.local
        members:
          - primary-adc-instance.local
          - secondary-adc-instance.local
        autoSync: false
        networkFailover: true
        saveOnAutoSync: false
        fullLoadOnSync: false
        asmSync: false
      trust:
        class: DeviceTrust
        localUsername: admin
        localPassword: {{ tmos_admin_password }}
        remoteHost: {{ secondary_cluster_ip }}
        remoteUsername: admin
        remotePassword: {{ tmos_admin_password }}
  as3_enabled: false
  post_onboard_enabled: false
  phone_home_url: "{{ phone_home_url }}"
bootcmd:
  - "printf \"platform=Z100\\nfamily=0xC000000\\nhost=Z100\\nsystype=0x71\\n\">/PLATFORM"